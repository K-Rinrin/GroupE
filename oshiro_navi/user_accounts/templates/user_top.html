{% extends "user_base.html" %}
{% load static %}
{% block content %}

<div class="user-top-logo" style="display: flex; justify-content: center; margin-bottom: 20px;">
    <img src="{% static 'image/top_logo.png' %}" alt="お城ナビロゴ" class="logo-image" style="width: 300px; height: auto;">
</div>

<hr>
<hr>
    <!--　お城写真スライダーエリア　-->
    <!-- 
    色んなお城の写真がSlider elementで見ることができる
    写真はお城のDBに入っているデータから持ってくる
    Slider elementはループするように作る
    写真をクリック、もしくは写真のところにある詳細ボタンを押すとそのお城情報ページへ飛ぶ
    -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<h3 class="wafu-title">城と歩む、日本を旅する。</h3>
<div class="top-carousel-container">
    <div class="swiper multiSwiper">
        <div class="swiper-wrapper">
            {% for oshiro in oshiro_list %}
            <div class="swiper-slide castle-card">
                <div class="card-image" style="background-image: url('{{ oshiro.oshiro_images.url }}');">
                    <a href="{% url 'usermy_list:oshiroinfo' oshiro.id %}" class="full-link"></a>
                </div>
                <div class="card-body" style="padding: 15px;">
                    <h3 class="castle-title" style="border-left: 4px solid #d4af37; padding-left: 10px; margin-bottom: 10px;">
                        {{ oshiro.oshiro_name }}
                    </h3>
                    <p class="castle-ex" style="color: #666; line-height: 1.6;">{{ oshiro.basicinfo.highlights|truncatechars:25 }}</p>
                    <a href="{% url 'usermy_list:oshiroinfo' oshiro.id %}" class="btn btn-detail-gold">
                        詳細を見る
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-pagination"></div>
    </div>
</div>

<hr>


<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<hr>

    <!-- 最新イベント情報エリア-->
    <!-- 今週のイベント情報を表示する-->

<div class="latest-events-container">
    <h2 class="section-title">今週のイベント</h2>
    <div class="event-list">
        {% for event in latest_events %}
        <div class="event-item" style="position: relative; overflow: hidden; display: flex; align-items: center; border: 1px solid #e0d8b0; border-radius: 15px; margin-bottom: 20px; background: #fdfcf0; padding: 15px;">
            
            <a href="{% url 'user_event_info:event_detail' event.event_type event.id %}" 
                class="full-link-overlay" 
                style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 10;">
            </a>

            <div class="event-content" style="flex: 1;">
                <p class="event-date-range" style="color: #8b7d3a; font-weight: bold; margin-bottom: 5px;">
                    {{ event.start_date|date:"Y/m/d" }}（{{ event.start_date|date:"D" }}）
                    〜 {{ event.end_date|date:"Y/m/d" }}（{{ event.end_date|date:"D" }}）
                </p>
                <h3 class="event-title" style="margin: 5px 0; color: #222;">
                    <span class="badge-castle" style="background: #d4af37; color: white; padding: 2px 10px; border-radius: 50px; font-size: 0.75em; margin-right: 10px;">
                        {{ event.venue|default:"城郭" }}
                    </span> 
                    {{ event.event_info }}
                </h3>
                <p class="event-description" style="color: #666; font-size: 0.9em; margin-top: 10px;">
                    {{ event.event_overview|truncatechars:100 }}
                </p>
                <a href="{% url 'user_event_info:event_detail' event.event_type event.id %}" class="btn btn-detail-gold">
                    詳細を見る
                </a>
            </div>
            
            <div class="event-image" style="width: 150px; margin-left: 15px;">
                {% if event.event_image %}
                    <img src="{{ event.event_image.url }}" alt="{{ event.event_info }}" style="width: 100%;">
                {% else %}
                    <img src="{% static 'image/default_castle.jpg' %}" alt="画像なし" style="width: 100%;">
                {% endif %}
            </div>
            
        </div>

        {% empty %}
        <div class="no-events" style="text-align: center; padding: 40px; color: #999;">
            <p>現在、開催予定のイベントはありません。</p>
        </div>
        {% endfor %}
    </div>
</div>

<hr>
<hr>

{% endblock %}
