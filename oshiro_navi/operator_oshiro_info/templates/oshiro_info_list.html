{% extends "operator_base.html" %}
{% block title %}お城情報一覧{% endblock %}

{% block content %}
<div class="content-container">
    <h1>お城情報一覧</h1>

    <a href="{% url 'operator_oshiro_info:register' %}" class="btn btn-register">
        ＋新規お城情報登録
    </a>

    <hr style="width:80%; margin-bottom: 10px; margin-top: 10px;"> 

    <table class="basic-info-table" style="margin-bottom: 30px;">
        <thead>
            <tr>
                <th>城名</th>
                <th>築城年</th>
                <th>住所</th>
                <th>構造</th>
                <th>遺構</th>
                <th>緯度</th>
                <th>経度</th>
                <th>操作</th>
            </tr>
        </thead>

        <tbody>
            {% for o in oshiros %}
            <tr class="basic-info-card">
                <td class="castle-name"><strong>{{ o.oshiro_name }}</strong></td>
                <td class="castle-row">{{ o.built_year }}年</td>
                <td class="castle-row">{{ o.address|truncatechars:4 }}</td>
                <td class="castle-row">{{ o.structure|truncatechars:10 }}</td>
                <td class="castle-row">{{ o.ruins|truncatechars:10 }}</td>

                <!-- ✅ 追加：未入力なら - 表示 -->
                <td class="castle-row">
                    {% if o.latitude is not None %}
                        {{ o.latitude|floatformat:6 }}
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td class="castle-row">
                    {% if o.longitude is not None %}
                        {{ o.longitude|floatformat:6 }}
                    {% else %}
                        -
                    {% endif %}
                </td>

                <td class="basic-info-actions">
                    <!-- ✅ update は ?id= が必要 -->
                    <a href="{% url 'operator_oshiro_info:update' %}?id={{ o.id }}" class="btn btn-update">
                        更新
                    </a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="8" style="text-align:center; padding:16px;">
                    登録されているお城情報はありません。
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}
