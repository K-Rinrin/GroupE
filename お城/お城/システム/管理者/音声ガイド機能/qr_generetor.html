<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>QRコード生成サンプル</title>
<style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", sans-serif; padding: 24px; max-width: 720px; margin: auto; }
    label { display:block; margin-top:12px; font-weight:600; }
    input[type="text"], select { width:100%; padding:8px; margin-top:6px; box-sizing:border-box; }
    .controls { display:flex; gap:8px; margin-top:10px; }
    button { padding:8px 12px; cursor:pointer; }
    #qrcode { margin-top:18px; padding:12px; border:1px solid #eee; display:inline-block; background:#fff; }
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body>

<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管理者TOP</title>

        <link rel="stylesheet" href="../../login_form/css/home.css">
        <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
    <!-- アイコン -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />


</head>

<body>  

    <!-- サイドバークラス -->
    <div class="sidebar">
        <div class="logo_content">
            <div class="logo">
                <div class="logo_name">管理者用画面</div>
            </div>
            <i class='bx bx-menu' id="btn"></i>
        </div>

        <ul class="nav">
        <li>
            <a href="../お城スタンプ機能/oshiro_stamp_registar.html">
                <i class="material-symbols-outlined">approval</i>
                <span class="link_name">お城スタンプ機能</span>
            </a>
            <span class="tooltip">お城スタンプ機能</span>
        </li>

            <li>
                <a href="../イベント情報機能/event_info_list.html">
                    <i class="material-symbols-outlined">calendar_month</i>
                    <span class="link_name">イベント情報機能</span>
                </a>
                <span class="tooltip">イベント情報機能</span>
            </li>
            <li>
                <a href="../周辺MAP機能/area_map_info_list.html">
                    <i class="material-symbols-outlined">map_pin_review</i>
                    <span class="link_name">周辺MAP機能</span>
                </a>
                <span class="tooltip">周辺MAP機能</span>
            </li>
            <li>
                <a href="../音声ガイド機能/audio_guide_list.html">
                    <i class="material-symbols-outlined">record_voice_over</i>
                    <span class="link_name">音声ガイド機能</span>
                </a>
                <span class="tooltip">音声ガイド機能</span>
            </li>
            <li>
                <a href="../基本情報機能/basic_info_list.html">
                    <i class="material-symbols-outlined">edit_document</i>
                    <span class="link_name">基本情報機能</span>
                </a>
                <span class="tooltip">基本情報機能</span>
            </li>
            <li>
                <a href="../モデルコース機能/model_couse_list.html">
                    <i class="material-symbols-outlined">alt_route</i> 
                    <span class="link_name">モデルコース機能</span>
                </a>
                <span class="tooltip">モデルコース機能</span>
            </li>
            <li>
                <a href="../音声ガイド機能/qr_generetor.html">
                    <i class="material-symbols-outlined">qr_code_2_add</i>
                    <span class="link_name">QRコード生成</span>
                </a>
                <span class="tooltip">QRコード生成</span>
            </li>
        </ul>
    </div>

    </div>
    <div class="home_content" id="qr_generetor">
        <h1>QRコードを生成する</h1>

<label for="text">QRにするテキスト・URL</label>
<input id="text" type="text" placeholder="例: https://example.com または 任意のテキスト" value="https://example.com">

<label for="size">サイズ (px)</label>
<select id="size">
    <option value="128">128</option>
    <option value="256" selected>256</option>
    <option value="512">512</option>
</select>

<label for="ec">誤り訂正レベル (Error Correction)</label>
<select id="ec">
    <option value="L">L - Low (7%)</option>
    <option value="M" selected>M - Medium (15%)</option>
    <option value="Q">Q - Quartile (25%)</option>
    <option value="H">H - High (30%)</option>
</select>

<div class="controls">
    <button id="generate">Generate</button>
    <button id="download" disabled>Download PNG</button>
    <button id="clear">Clear</button>
</div>

<div id="qrcode" aria-live="polite"></div>

<!-- ▼ ロゴ画像（非表示でOK） ▼ -->
<img id="logo" src="../../../../お城写真/お城ナビアイコン-removebg-preview.png" style="display:none;">

<script>
let qr = null;

const elText = document.getElementById('text');
const elSize = document.getElementById('size');
const elEC = document.getElementById('ec');
const elGenerate = document.getElementById('generate');
const elDownload = document.getElementById('download');
const elClear = document.getElementById('clear');
const elQrcode = document.getElementById('qrcode');

function clearQrcode() {
    elQrcode.innerHTML = '';
    qr = null;
    elDownload.disabled = true;
}

function generateQrcode() {
    const text = elText.value.trim();
    if (!text) {
        alert('まずテキストまたはURLを入力してください。');
        return;
    }

    clearQrcode();

    const size = parseInt(elSize.value, 10) || 256;
    const ec = elEC.value || 'M';

    qr = new QRCode(elQrcode, {
        text: text,
        width: size,
        height: size,
        correctLevel: QRCode.CorrectLevel[ec]
    });

    setTimeout(() => {
        insertLogo(size);
        elDownload.disabled = false;
    }, 300);
}

function insertLogo(size) {
    const img = elQrcode.querySelector("img");
    if (!img) return;

    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");

    canvas.width = size;
    canvas.height = size;

    const qrImage = new Image();
    qrImage.src = img.src;

    qrImage.onload = () => {
        ctx.drawImage(qrImage, 0, 0, size, size);

        const logo = document.getElementById("logo");
        const logoSize = size * 0.25; // ロゴの大きさ
        const x = (size - logoSize) / 2;
        const y = (size - logoSize) / 2;

        ctx.drawImage(logo, x, y, logoSize, logoSize);

        // QR画像をロゴ入りのキャンバス画像に差し替え
        img.src = canvas.toDataURL("image/png");
    };
}

function downloadQrcode() {
    const img = elQrcode.querySelector('img');
    if (!img) return;

    const a = document.createElement('a');
    a.href = img.src;
    a.download = 'qrcode.png';
    a.click();
}

elGenerate.addEventListener('click', generateQrcode);
elDownload.addEventListener('click', downloadQrcode);
elClear.addEventListener('click', clearQrcode);

elText.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
        e.preventDefault();
        generateQrcode();
    }
});

window.addEventListener('load', () => {
    generateQrcode();
});
</script>

<script src="../../login_form/JS/home.js"></script>
    </div>
</body>
</html>


